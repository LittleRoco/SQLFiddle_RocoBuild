define(["CodeMirror","MySQLCodeMirror","jQuery"],function(e,t,n){var r=function(t,r,i,s){return this.codeMirrorSupported=!/Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent),this.codeMirrorSupported?(this.codeMirror=e.fromTextArea(document.getElementById(t),{mode:"mysql",matchBrackets:!0,extraKeys:{Tab:"indentMore"},lineNumbers:!0,onChange:function(){r.call(i)}}),n(this.codeMirror.getWrapperElement()).on("keypress",function(e){e.keyCode==13&&e.ctrlKey&&s&&(e.preventDefault(),s())})):(this.textArea=document.getElementById(t),n(this.textArea).on("change",function(){r.call(i)}),n(this.textArea).on("keyup",function(){r.call(i)}),n(this.textArea).on("keypress",function(e){e.keyCode==13&&e.ctrlKey&&s&&(e.preventDefault(),s())}),n(this.textArea).attr("fullscreen",!1)),this};return r.prototype.getValue=function(){return this.codeMirrorSupported?this.codeMirror.getValue():this.textArea.value},r.prototype.setValue=function(e){this.codeMirrorSupported?this.codeMirror.setValue(e):(this.textArea.value=e,n(this.textArea).trigger("change"))},r.prototype.refresh=function(){this.codeMirrorSupported&&this.codeMirror.refresh()},r.prototype.somethingSelected=function(){return this.codeMirrorSupported?this.codeMirror.somethingSelected():!1},r.prototype.getSelection=function(){return this.codeMirrorSupported?this.codeMirror.getSelection():this.textArea.value},r.prototype.getScrollerElement=function(){return this.codeMirrorSupported?this.codeMirror.getScrollerElement():null},r.prototype.getGutterElement=function(){return this.codeMirrorSupported?this.codeMirror.getGutterElement():null},r.prototype.isFullscreen=function(){return this.codeMirrorSupported?n(this.codeMirror.getScrollerElement()).hasClass("CodeMirror-fullscreen"):n(this.textArea).attr("fullscreen")==1},r.prototype.setFullscreen=function(e){if(e){var t=n(window).height()-40;this.codeMirrorSupported?(n(this.codeMirror.getScrollerElement()).addClass("CodeMirror-fullscreen").height(t),n(this.codeMirror.getGutterElement()).height(t)):(n(this.textArea).addClass("fullscreen"),n(this.textArea).height(t),n(this.textArea).attr("fullscreen",e))}else this.codeMirrorSupported?(n(this.codeMirror.getScrollerElement()).removeClass("CodeMirror-fullscreen"),n(this.codeMirror.getGutterElement()).css("height","auto"),n(this.codeMirror.getScrollerElement()).css("height","200px")):(n(this.textArea).removeClass("fullscreen"),n(this.textArea).height(100),n(this.textArea).attr("fullscreen",e))},r})
define(["jQuery","BrowserEngines/sqlite_driver"],function(e,t){var n=function(){return this.db=null,this};return e.extend(n.prototype,t.prototype),n.prototype.buildSchema=function(n){var r=this;try{var i=function(){r.db=SQL.open(),e.each(t.prototype.splitStatement.call(this,n.ddl,n.statement_separator),function(e,t){r.db.exec(t)}),n.success()};window.SQL===undefined?e.getScript("javascripts_static/sql.js",function(e,t,n){i()}).fail(function(e,t,r){n.error("Your browser does not work with SQL.js.  Try using a different browser (Chrome, Safari, Firefox, IE 10, etc...), or a newer version of your current one.")}):(r.db&&r.db.close(),i())}catch(s){n.error(s)}},n.prototype.executeQuery=function(n){var r=this;try{if(!r.db)throw"Database Schema not available!";var i=[];r.db.exec("BEGIN TRANSACTION"),e.each(t.prototype.splitStatement.call(this,n.sql,n.statement_separator),function(t,n){if(e.trim(n).length){var s=new Date,o=[];try{o=r.db.exec(n);var u={SUCCEEDED:!0,STATEMENT:n,EXECUTIONTIME:new Date-s,RESULTS:{COLUMNS:[],DATA:[]},EXECUTIONPLAN:{COLUMNS:[],DATA:[]}};o.length&&e.each(o,function(t,n){var r=[];e.each(n,function(e,n){t==0&&u.RESULTS.COLUMNS.push(n.column),r.push(n.value)}),u.RESULTS.DATA.push(r)});try{exectionPlanArray=r.db.exec("EXPLAIN QUERY PLAN "+n),exectionPlanArray.length&&e.each(exectionPlanArray,function(t,n){var r=[];e.each(n,function(e,n){t==0&&u.EXECUTIONPLAN.COLUMNS.push(n.column),r.push(n.value)}),u.EXECUTIONPLAN.DATA.push(r)})}catch(a){}i.push(u)}catch(a){var u={SUCCEEDED:!1,EXECUTIONTIME:new Date-s,ERRORMESSAGE:a};return i.push(u),!1}}}),r.db.exec("ROLLBACK TRANSACTION"),n.success(i)}catch(s){n.error(s)}},n})
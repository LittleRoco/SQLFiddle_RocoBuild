define(["Backbone"],function(e){var t=e.Model.extend({defaults:{ddl:"",short_code:"",simple_name:"",full_name:"",valid:!0,errorMessage:"",loading:!1,ready:!1,schema_structure:[],statement_separator:";",browserEngines:{}},reset:function(){this.set(this.defaults),this.trigger("reloaded")},build:function(){var e=this.get("dbType"),t=this;$.ajax({type:"POST",url:"index.cfm/fiddles/createSchema",data:{statement_separator:this.get("statement_separator"),db_type_id:this.get("dbType").id,schema_ddl:this.get("ddl")},dataType:"json",success:function(n,r,i){n.short_code?e.get("context")=="browser"?t.get("browserEngines")[e.get("className")].buildSchema({short_code:$.trim(n.short_code),statement_separator:t.get("statement_separator"),ddl:t.get("ddl"),success:function(){t.set({short_code:$.trim(n.short_code),ready:!0,valid:!0,errorMessage:""}),t.get("browserEngines")[e.get("className")].getSchemaStructure({callback:function(e){t.set({schema_structure:e}),t.trigger("built")}})},error:function(e){t.set({short_code:$.trim(n.short_code),ready:!1,valid:!1,errorMessage:e,schema_structure:[]}),t.trigger("failed")}}):(t.set({short_code:$.trim(n.short_code),ready:!0,valid:!0,errorMessage:"",schema_structure:n.schema_structure}),t.trigger("built")):(t.set({short_code:"",ready:!1,valid:!1,errorMessage:n.error,schema_structure:[]}),t.trigger("failed"))},error:function(e,n,r){t.set({short_code:"",ready:!1,valid:!1,errorMessage:r,schema_structure:[]}),t.trigger("failed")}})}});return t})